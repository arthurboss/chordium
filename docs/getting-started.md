# Getting Started

## Prerequisites

- Node.js (v16+)
- npm

## Installation

```sh
# Clone the repository
git clone https://github.com/arthurboss/chordium.git

# Navigate to the project directory
cd chordium

# Install all dependencies (npm workspaces handle this automatically)
npm install
```

## Workspace Structure

This monorepo contains the following workspaces:

- **`frontend/`** - React/Vite application with PWA features
- **`backend/`** - Node.js/Express API server
- **`packages/types/`** - Shared TypeScript types published to npm
- **`packages/e2e-tests/`** - End-to-end testing suite

See individual README files for detailed documentation:
- [Frontend README](../frontend/README.md) - Frontend development and PWA features
- [Backend README](../backend/README.md) - API development and deployment

## Static Assets Architecture

Chordium uses a **hybrid architecture** for static assets to ensure PWA functionality works correctly:

### Main Repository (This Repo)
- **Application code** - React frontend, Node.js backend, shared types
- **PWA manifest** - Generated by VitePWA plugin (served from same origin)
- **App-specific assets** - `robots.txt`, build artifacts
- **Protected by Vercel Authentication** - Secure deployment

### External Repository
- **Repository**: [`chordium-static`](https://github.com/arthurboss/chordium-static)
- **Purpose**: PWA icons and favicons served publicly via GitHub Pages
- **URL**: https://arthurboss.github.io/chordium-static/
- **Contents**: 
  - `favicon.ico` and favicon variants
  - PWA icons (`icon-maskable-512.png`)
  - Other static assets referenced by the PWA manifest

### Why This Architecture?

This setup ensures PWA functionality works correctly while keeping the main application secure:
- âœ… **No cross-origin manifest issues** - Manifest served from same origin as app
- âœ… **No authentication conflicts** - Icons served from GitHub Pages
- âœ… **Secure main app** - Vercel Authentication enabled for application routes
- âœ… **Clean separation** - App code vs static assets
- âœ… **Easy maintenance** - Update static assets in dedicated repository


The frontend will be available at http://localhost:8080.

The backend will be available at http://localhost:3001.

ðŸ“Š **Production Backend Status**: [Monitor API uptime](https://stats.uptimerobot.com/sIX45GbfwC)

## Monorepo Commands

```bash
# Development
npm run dev              # Start both frontend and backend
npm run dev:fe           # Start only frontend
npm run dev:be           # Start only backend
npm run dev:pwa          # Start PWA development (HTTPS) + backend

# Testing
npm run test             # Run all tests
npm run test:watch       # Run tests in watch mode
npm run test:fe          # Run only frontend tests
npm run test:be          # Run only backend tests
npm run test:e2e         # Run end-to-end tests
npm run test:e2e:open    # Open Cypress test runner
npm run test:e2e:headed  # Run E2E tests with browser visible
npm run test:e2e:dev     # Run E2E tests against dev server

# Code Quality
npm run lint             # Lint all code
npm run lint:fix         # Auto-fix linting issues
npm run check:fixtures   # Check for duplicate fixtures

# Building
npm run build            # Build both frontend and backend
npm run build:fe         # Build only frontend
npm run build:be         # Build only backend
npm run build:types      # Build shared types package

# Running
npm run start            # Build and start production servers
npm run start:fe         # Start frontend preview server
npm run start:be         # Start backend server

# Package Management
npm run clean            # Clean all node_modules and build artifacts
npm run clean:install    # Clean and reinstall all dependencies
npm run use-workspace    # Switch to workspace dependencies
npm run use-npm          # Switch to npm dependencies

# Utilities
npm run kill             # Kill all development servers
npm run kill:fe          # Kill frontend server only
npm run kill:be          # Kill backend server only
```

## PWA Development

Chordium includes Progressive Web App (PWA) features for offline functionality and mobile app-like experience.

### Quick Setup

```sh
# Setup PWA development environment
npm run setup:pwa
```

### Development

```sh
# PWA development (HTTPS, full PWA features + backend)
npm run dev:pwa
```

### Static Assets

PWA icons and favicons are served from the external [`chordium-static`](https://github.com/arthurboss/chordium-static) repository via GitHub Pages. The PWA manifest is generated by VitePWA plugin and served from the same origin as the application, ensuring proper PWA functionality without cross-origin issues.

For detailed PWA development workflow, see [Frontend README](../frontend/README.md).

## ðŸ“¦ @chordium/types Package

Chordium publishes a shared TypeScript types package to npm for type safety across the entire monorepo:

- **Package**: [`@chordium/types`](https://www.npmjs.com/package/@chordium/types)
- **Purpose**: Shared type definitions for API contracts, data models, and interfaces
- **Usage**: Currently used by frontend; backend still uses local types due to Render deployment constraints
- **Build**: Automatically built and versioned with Turborepo dependency management

```sh
# Install in your project
npm install @chordium/types
```

```typescript
// Import shared types
import { Song, Artist, ChordSheet } from "@chordium/types";
```
